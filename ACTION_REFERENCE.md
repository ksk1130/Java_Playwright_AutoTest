# テストアクションリファレンス

このドキュメントでは、CSVファイルで使用可能なアクションの一覧と使用方法を説明します。

## 基本的なアクション

### 1. ページナビゲーション
- **アクション**: `アクセス`, `navigate`, `goto`, `移動`
- **要素**: URL（例: `https://example.com` or `example.com`）
- **入力値**: 不要
- **説明**: 指定されたURLにアクセスします

### 2. クリック操作
- **アクション**: `クリック`, `click`, `押下`
- **要素**: クリックしたい要素の指定
- **入力値**: 不要
- **説明**: 指定された要素をクリックします

### 3. テキスト入力
- **アクション**: `入力`, `input`, `type`, `タイプ`
- **要素**: 入力フィールドの指定
- **入力値**: 入力したいテキスト
- **説明**: 指定されたフィールドにテキストを入力します

### 4. 選択操作（プルダウン）
- **アクション**: `選択`, `select`, `dropdown`
- **要素**: セレクトボックスの指定
- **入力値**: 選択したい値またはテキスト
- **説明**: ドロップダウンから値を選択します

**プルダウン選択の例:**
```csv
ステップ,アクション,要素,入力値,期待結果,説明
5,選択,#country,Japan,,国を選択
6,選択,select[name='prefecture'],東京都,,都道府県を選択
7,選択,カテゴリ,電子機器,,ラベルでカテゴリを選択
8,選択,.dropdown-year,2024,,年を選択
```

**選択方法の種類:**
- **値（value）で選択**: `Japan`, `tokyo`, `category1`
- **表示テキストで選択**: `東京都`, `電子機器`, `2024年`
- **インデックスで選択**: `0`, `1`, `2` (0から開始)

**要素指定の種類:**
- **ID**: `#countrySelect`
- **Name属性**: `select[name='country']`
- **クラス**: `.country-dropdown`
- **ラベルテキスト**: `国を選択` (近くのlabelタグのテキスト)

### 5. チェックボックス操作
- **アクション**: `チェック`, `check`, `checkbox`
- **要素**: チェックボックスの指定
- **入力値**: 不要
- **説明**: チェックボックスをチェックします

- **アクション**: `チェック解除`, `uncheck`, `uncheckbox`
- **要素**: チェックボックスの指定
- **入力値**: 不要
- **説明**: チェックボックスのチェックを解除します

### 6. マウス操作
- **アクション**: `ホバー`, `hover`, `マウスオーバー`
- **要素**: ホバーしたい要素の指定
- **入力値**: 不要
- **説明**: 指定された要素にマウスを合わせます

### 7. スクロール操作
- **アクション**: `スクロール`, `scroll`
- **要素**: スクロール先の要素の指定
- **入力値**: 不要
- **説明**: 指定された要素までスクロールします

### 8. 待機
- **アクション**: `待機`, `wait`, `wait for`
- **要素**: 待機する要素の指定
- **入力値**: 不要
- **説明**: 指定された要素が表示されるまで待機します

### 9. 検証
- **アクション**: `確認`, `verify`, `検証`, `assertion`
- **要素**: 確認したい要素の指定（`title`, `url`, または要素セレクタ）
- **入力値**: 期待される値
- **説明**: 指定された要素が期待される値を含むかどうかを確認します

### 10. ページ操作
- **アクション**: `更新`, `refresh`, `reload`, `リロード`
- **要素**: 不要
- **入力値**: 不要
- **説明**: ページを更新します

- **アクション**: `戻る`, `back`, `前のページ`
- **要素**: 不要
- **入力値**: 不要
- **説明**: ブラウザの戻るボタンを押します

- **アクション**: `進む`, `forward`, `次のページ`
- **要素**: 不要
- **入力値**: 不要
- **説明**: ブラウザの進むボタンを押します

### 11. スクリーンショット
- **アクション**: `スクリーンショット`, `screenshot`, `画面キャプチャ`
- **要素**: ファイル名（省略可）
- **入力値**: 不要
- **説明**: 現在のページのスクリーンショットを撮影します

### 12. iframe操作
- **アクション**: `iframe`, `アイフレーム`, `フレーム`
- **要素**: iframeのセレクタ
- **入力値**: 不要
- **説明**: 指定されたiframeに切り替えます。以降の操作はそのiframe内で実行されます

- **アクション**: `main`, `メイン`, `親フレーム`
- **要素**: 不要
- **入力値**: 不要
- **説明**: メインフレーム（親ページ）に戻ります

**iframe操作の例:**
```csv
ステップ,アクション,要素,入力値,期待結果,説明
5,iframe,#myFrame,,,iframeに切り替え
6,入力,#username,testuser,,iframe内のフィールドに入力
7,クリック,#submitBtn,,,iframe内のボタンをクリック
8,main,,,,,メインページに戻る
```

### 13. ウィンドウ操作（ポップアップ）
- **アクション**: `newwindow`, `新しいウィンドウ`, `ポップアップ`
- **要素**: 不要
- **入力値**: 不要
- **説明**: 新しく開いたウィンドウ（ポップアップ）に切り替えます

- **アクション**: `window`, `ウィンドウ`, `ウィンドウ切り替え`
- **要素**: 不要
- **入力値**: ウィンドウのインデックス（0,1,2...）またはタイトルの一部
- **説明**: 指定されたウィンドウに切り替えます

- **アクション**: `closewindow`, `ウィンドウを閉じる`, `ポップアップを閉じる`
- **要素**: 不要
- **入力値**: 不要
- **説明**: 現在のウィンドウを閉じて前のウィンドウに戻ります

**ウィンドウ操作の例:**
```csv
ステップ,アクション,要素,入力値,期待結果,説明
5,クリック,#openPopup,,,ポップアップを開くボタンをクリック
6,newwindow,,,,,新しく開いたポップアップに切り替え
7,入力,#popupInput,テストデータ,,ポップアップ内のフィールドに入力
8,クリック,#popupSubmit,,,ポップアップ内の送信ボタンをクリック
9,closewindow,,,,,ポップアップを閉じて元のウィンドウに戻る
10,window,,0,,元のウィンドウ（インデックス0）に明示的に切り替え
```

**新しいウィンドウ + iframe の複合操作例:**
```csv
ステップ,アクション,要素,入力値,期待結果,説明
5,クリック,#openPaymentWindow,,,決済ウィンドウを開くボタンをクリック
6,newwindow,,,,,新しく開いた決済ウィンドウに切り替え
7,iframe,#paymentFrame,,,決済ウィンドウ内のiframeに切り替え
8,入力,#cardNumber,1234567890123456,,iframe内のカード番号フィールドに入力
9,入力,#expiryDate,12/25,,iframe内の有効期限フィールドに入力
10,クリック,#submitPayment,,,iframe内の決済ボタンをクリック
11,main,,,,,決済ウィンドウのメインフレームに戻る
12,確認,title,決済完了,,決済完了ページであることを確認
13,closewindow,,,,,決済ウィンドウを閉じる
14,window,,0,,元のメインウィンドウに戻る
```

## 要素の指定方法

### 1. CSS セレクタ
```
#id               → ID指定
.class            → クラス指定
input[name='q']   → 属性指定
button:first-child → 疑似セレクタ
```

### 2. テキストベース
```
ログイン          → 「ログイン」というテキストを含む要素
Login             → 「Login」というテキストを含む要素
```

### 3. 属性ベース
```
username          → name属性、placeholder、label等で「username」を含む要素
```

### 4. 特殊な指定
```
検索ボタン        → 検索ボタンとして認識
検索結果1つ目      → 検索結果の最初の項目として認識
検索              → 検索ボックスとして認識
```

## 使用例

### ログインシナリオ
```csv
ステップ,アクション,要素,入力値,期待結果,説明
1,アクセス,https://example.com/login,,,"ログインページにアクセス"
2,入力,#email,test@example.com,,メールアドレスを入力
3,入力,#password,password123,,パスワードを入力
4,クリック,#loginButton,,,ログインボタンをクリック
5,確認,title,Dashboard,,ダッシュボードページに遷移することを確認
```

### 検索シナリオ
```csv
ステップ,アクション,要素,入力値,期待結果,説明
1,アクセス,https://example.com,,,"サイトにアクセス"
2,入力,検索,キーワード,,検索ボックスにキーワードを入力
3,クリック,検索ボタン,,,検索を実行
4,確認,title,検索結果,,検索結果ページに遷移することを確認
```

### フォーム入力シナリオ
```csv
ステップ,アクション,要素,入力値,期待結果,説明
1,アクセス,https://example.com/form,,,"フォームページにアクセス"
2,入力,.name-input,山田太郎,,名前を入力
3,選択,#prefecture,東京都,,都道府県を選択
4,チェック,#agree,,,利用規約に同意
5,クリック,button[type='submit'],,,送信ボタンをクリック
6,スクリーンショット,form_submitted,,,送信完了画面をキャプチャ
```

## 複合操作の例

### iframe + 新しいウィンドウの組み合わせシナリオ
```csv
ステップ,アクション,要素,入力値,期待結果,説明
1,アクセス,https://example.com/shop,,,"ショップサイトにアクセス"
2,クリック,#buyNowBtn,,,購入ボタンをクリック
3,newwindow,,,,,新しく開いた決済ウィンドウに切り替え
4,確認,title,決済,,決済ページであることを確認
5,iframe,#creditCardFrame,,,決済ウィンドウ内の決済フレームに切り替え
6,入力,#cardNumber,4111111111111111,,iframe内のカード番号フィールドに入力
7,入力,#expiryDate,12/25,,iframe内の有効期限フィールドに入力
8,入力,#cvv,123,,iframe内のCVVフィールドに入力
9,クリック,#submitPayment,,,iframe内の決済実行ボタンをクリック
10,main,,,,,決済ウィンドウのメインフレームに戻る
11,確認,.success-message,成功,,決済成功メッセージの確認
12,スクリーンショット,payment_success,,,決済成功画面をキャプチャ
13,closewindow,,,,,決済ウィンドウを閉じる
14,window,,0,,元のショップページに戻る
15,確認,title,注文完了,,注文完了ページに遷移したことを確認
```

## 注意事項

1. **要素の指定**: 要素が見つからない場合、複数の方法で自動的に検索を試行します
2. **待機時間**: 各アクションの間に自動的に待機時間が挿入されます
3. **エラーハンドリング**: 要素が見つからない場合やアクションが失敗した場合、詳細なエラーメッセージが表示されます
4. **スクリーンショット**: テスト失敗時には自動的にスクリーンショットが撮影されます

## CSV ファイルの作成のコツ

1. **明確な説明**: 各ステップに分かりやすい説明を記載する
2. **段階的な操作**: 複雑な操作は複数のステップに分割する
3. **検証の追加**: 重要なポイントで確認ステップを追加する
4. **スクリーンショット**: 重要な画面でスクリーンショットを撮影する
